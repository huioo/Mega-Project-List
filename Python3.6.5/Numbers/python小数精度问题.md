# 问题如何引起？

从下面可以看出`10.1*10.1`的结果出现问题，原结果应该是`102.01`。
```python
>>> 10.1**2
102.00999999999999
>>> 10.1*10.1
102.00999999999999
>>> 101*101
10201
>>> 10.1
10.1
```
由此发现可能是Python的浮点数损失精度问题，参考至http://www.cnblogs.com/hdk1993/p/8893954.html。

```python
>>> 2**52
4503599627370496
>>> 2**52/10
450359962737049.6
>>> 2**52/10**17
0.04503599627370496
>>> 2**52/10**16
0.4503599627370496
>>> str(2**52/10**16)
'0.4503599627370496'
>>> len(str(2**52/10**16))
18
```
参考博客中
> 因为 Python 中使用双精度浮点数来存储小数。在 Python 使用的 IEEE 754 标准（52M/11E/1S）中，8字节64位存储空间分配了52位来存储浮点数的有效数字，11位存储指数，1位存储正负号，即这是一种二进制版的科学计数法格式。

> 虽然52位有效数字看起来很多，但麻烦之处在于，**二进制小数在表示有理数时极易遇到`无限循环`的问题**。其中很多在十进制小数中是有限的，比如十进制的 1/10，在十进制中可以简单写为 0.1 ，但在二进制中，他得写成：0.0001100110011001100110011001100110011001100110011001…..（后面全是 1001 循环）。因为浮点数只有52位有效数字，从第53位开始，就舍入了。这样就造成了标题里提到的”浮点数精度损失“问题。 舍入（round）的规则为“0 舍 1 入”，所以有时候会稍大一点有时候会稍小一点。

```python
>>> def bin2dec(b):
...   """ 二进制字符串转换成数字 """
...   d = 0
...   for i, x in enumerate(b):
...     d += 2**(-i-1)*x
...   return d
... 
>>> def dec2bin(x):
...   """ 小数转换成二进制形式 """
...   x -= int(x)
...   bins = []
...   while x:
...     x *= 2
...     bins.append(1 if x>=1. else 0)
...     x -= int(x)
...   return bins
... 
>>> dec2bin(0.1)
[0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1]
>>> len(dec2bin(0.1))
55
>>> print('0.', *dec2bin(0.1), sep='')
0.0001100110011001100110011001100110011001100110011001101


>>> len(dec2bin(1.0201))
52
>>> print('0.', *dec2bin(1.0201), sep='')
0.0000010100100101010001100000101010100110010011000011


>>> len(dec2bin(1.1))
51
>>> print('0.', *dec2bin(1.0201), sep='')
0.0000010100100101010001100000101010100110010011000011


>>> 2**57
144115188075855872
>>> 0.1*(2**57)  # 次数精度缺失
1.4411518807585588e+16

>>> print('0.', *dec2bin(0.2), sep='')  # 两者二进制表示相同
0.001100110011001100110011001100110011001100110011001101
>>> print('0.', *dec2bin(0.20000000000000001), sep='')  
0.001100110011001100110011001100110011001100110011001101


```
